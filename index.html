<!doctype html>
<html lang="en-US">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <!-- Begin Jekyll SEO tag v2.3.0 -->
    <title>boundary-first-flattening</title>
    <meta property="og:title" content="boundary-first-flattening" />
    <meta property="og:locale" content="en_US" />
    <link rel="canonical" href="https://geometrycollective.github.io/boundary-first-flattening/" />
    <meta property="og:url" content="https://geometrycollective.github.io/boundary-first-flattening/" />
    <meta property="og:site_name" content="boundary-first-flattening" />
    <script type="application/ld+json">
        {
            "name": "boundary-first-flattening",
            "description": null,
            "author": null,
            "@type": "WebSite",
            "url": "https://geometrycollective.github.io/boundary-first-flattening/",
            "image": null,
            "publisher": null,
            "headline": "boundary-first-flattening",
            "dateModified": null,
            "datePublished": null,
            "sameAs": null,
            "mainEntityOfPage": null,
            "@context": "http://schema.org"
        }
    </script>
    <!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/boundary-first-flattening/assets/css/style.css?v=7882938d72e296dffcfd9777b3d951a0fa644ac2">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>

<body>
    <div class="wrapper">
        <header>
            <img src="imgs/logo.png" width="190" height="190" />

            <p class="view"><a href="https://github.com/GeometryCollective/boundary-first-flattening">View the Project on GitHub <small></small></a></p>

            <br>
            <a href="http://geometry.cs.cmu.edu"><img src="imgs/geometry-collective-production.png" width="190" height="173.2192" /></a>

            <br>
            <br>
            <br>
            <p>This project is maintained by <a href="https://github.com/GeometryCollective">GeometryCollective</a></p>

            <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
        </header>
        <section>

            <h1>Boundary First Flattening (BFF)</h1>

            <p>Boundary First Flattening is a blazing fast and user-friendly desktop application for surface parameterization. Unlike other tools for UV mapping, BFF allows free-form editing of the flattened mesh, maintaining a high-quality map which is
                updated in real time. The user gains direct control over the shape of the flattened domain, rather than being stuck with whatever the algorithm provides. For users seeking an automatic parameterization, BFF can also produce UV maps with
                area distortion mathematically guaranteed to be lower than any other conformal mapping tool. It also implements some state-of-the art flattening techniques not available in other packages (such as <em>cone singularities</em>, which can
                dramatically reduce area distortion), and allows real-time editing of meshes with hundreds of thousands of triangles.</p>

            <img src="imgs/teaser.png" height="475" width="475" align="center" />

            <h1 id="features">Feature Gallery</h1>

            <ol>
                <li>
                    <p>Automatic parameterization with minimal area distortion. This map is generated by default when the application is launched.</p>
                </li>
                <li>
                    <p>Direct manipulation of boundary lengths or angles of the flattened domain with a spline based curve editor.</p>
                </li>
                <li>
                    <p>Exact preservation of sharp corners for flattened domains like rectangles.</p>
                </li>
                <li>
                    <p>Seamless cone parameterization. This is a powerful technique for mitigating area distortion that first maps to a cone surface, which is flat everywhere except at a collection of isolated points. After cutting through these points,
                        the cone surface is flattened into the plane without further distortion. Users can pick cones manually or use a built in algorithm to pick them automatically. Cutting is automatic.</p>
                </li>
                <li>
                    <p>Mapping to a unit disk for surfaces with boundary.</p>
                </li>
                <li>
                    <p>Mapping to a unit sphere for sphere like surfaces.</p>
                </li>
            </ol>

            <h1 id="download-application">Download Application</h1>

            <blockquote>
                <p><a href="https://www.google.com">Mac OSX</a><br />
                    <a href="https://www.google.com">Windows</a></p>
            </blockquote>

            <h1 id="tutorial">Tutorial</h1>

            <img src="imgs/tutorial/bff_edit.gif" width="504" height="291" align="center" />

            <p>BFF should be fairly intuitive to use, so go ahead and give it a try! If you find you still have questions, the tutorial below may provide some useful guidance. (<em>Warning:</em> As with most tutorials, this one will probably not always stay
                in sync with the latest software version. Use at your own risk! ;-))</p>

            <h3 id="tutorial_gui">The BFF interface</h3>
            <p>The BFF interactive tool loads a single triangle mesh in OBJ format, and produces a flattened mesh (also in OBJ format). Currently this mesh must have either spherical or disk topology, and must have <a href="http://15462.courses.cs.cmu.edu/fall2017/lecture/meshesandmanifolds/slide_013">manifold connectivity</a>                (though some of these restrictions may be relaxed in future versions). Initially, the GUI should look something like this:</p>

            <img src="imgs/tutorial/bff_gui.jpg" width="648" height="349" align="center" />

            <p>The <b>3D View</b> shows the original mesh, the <b>UV view</b> shows the current flattening. Since BFF is incredibly fast, you <em>do not have to take any action</em> to get an updated flattening; the UV view will be automatically refreshed
                whenever you click on a button or other UI element. The <b>Toolbar</b> provides various options for flattening the surface; pay close attention to the <b>Tool Tips</b>, which can provide useful information about the currently selected
                tool. By default, the UV map is visualized as a grid on the surface; the shading on the surface is also used to light the UV map, to give a sense of correspondence between 3D and 2D. Additional visualization options are described below.
                Finally, the <b>Reset</b> button will set the current tool (and the correspoding flattening) back to its default parameters.</p>

            <p>New meshes can be loaded by pressing the <b>Load Mesh</b> button; the <b>Export Mesh</b> button allows a mesh to be exported to OBJ format, with the texture coordinates stored in the <tt>vt</tt> field (one per distinct triangle corner in the
                flattened mesh).</p>

            <h4 id="tutorial_view">Adjusting the View</h4>
            <p>The view can be independently adjusted in both the <b>3D view</b> and the <b>UV view</b>. In particular:</p>

            <ul>
                <li><em>rotate</em> &mdash; click and drag on any point in the background (not on the mesh)</li>
                <li><em>translate</em> &mdash; alt/option-click on the background</li>
                <li><em>zoom in/out</em> &mdash; scroll up/down</li>
            </ul>

            <h4 id="tutorial_visualization">Visualization Options</h4>
            <p>In addition to visualizing the map itself, BFF provides facilities for inspecting the quality of the map. The <b>Shading Menu</b> (first menu in the <b>Plot</b> section) provides the following options:</p>

            <ul>
                <li><em>Constant</em> &mdash; no special shading; useful for looking at the wireframe or checking for local overlaps. In this view, flipped triangles (which are fairly rare) will be drawn in bright red.</li>
                <li><em>Shaded</em> &mdash; the mesh in the UV view will be lit using the shading from the 3D view. This shading gives a quick way to see which features get mapped where.</li>
                <li><em>Conformal Distortion</em> &mdash; shows angle distortion in the mapping. Blue means no angle distortion, green means a little angle distortion, and red means a lot of angle distortion. For reasonably nice meshes (e.g., smallish triangles,
                    not too crazy aspect ratios) you should see very little angle distortion. Large angle distortion on simple models may indicate that there is something wrong with your mesh (e.g., long invisible slivers or near-degenerate elements).
                    In this mode, the total angle distortion will be printed out above the <b>Shading Menu</b> (this quantity is the average and maximum <em>quasi conformal distortion</em>, where 1 means no distortion).</li>
                <li><em>Area Distortion</em> &mdash; shows how much area is distorted by the mapping. White means no area distortion, blue means shrinking, and red means expansion. In this mode, the total area distortion will be printed out above the <b>Shading Menu</b>                    (this quantity is the average and maximum <em>log conformal factor</em>, where zero means no distortion).</li>
            </ul>

            <img src="imgs/tutorial/bff_shading.jpg" width="743" height="223" align="center" />

            <p>The <b>Pattern Menu</b> draws different patterns on the surface. These patterns have been chosen to give a sense of the angle and area distortion in the flattening. For a perfect map (<em>i.e.,</em> no distortion at all) the pattern should
                look uniform in scale across the whole surface, and circles and squares in the UV view should look like circles and squares in the 3D view (taking perspective distortion into account). These features will give you a sense of how textures
                and other data will look when mapped onto the surface. In particular:</p>

            <ul>
                <li><em>None</em> &mdash; no pattern is displayed. Useful for getting a clear view of other features of the map (<em>e.g.,</em> area distortion, or the wireframe).</li>
                <li><em>Grid</em> &mdash; draws a regular grid pattern. (Note that for maps with cones or cuts, grid lines will line up exactly only if the map is made seamless.)</li>
                <li><em>Checkerboard</em> &mdash; draws a regular checkerboard pattern. (Note that even for seamless maps there may be a jump from black to white, due to parity considerations.)</li>
                <li><em>Circles</em> &mdash; draws random circles. For a map with low angle distortion, these circles should still look like circles (rather than ellipses) on the 3D surface.</li>
            </ul>

            <img src="imgs/tutorial/bff_patterns.jpg" width="626" height="220" align="center" />

            <p>The <b>Pattern Scale Slider</b>, found directly below the <b>Pattern Menu</b>, will adjust the scale of the pattern. Such adjustment can be useful for, <em>e.g.,</em> understanding what's going on in a map with high area distortion.</p>

            <img src="imgs/tutorial/bff_scale.gif" width="143" height="184" align="center" />

            <p>The <b>Show Wireframe</b> checkbox toggles display of a wireframe over the mesh edges, which can be helpful for visualizating the map.</p>

            <img src="imgs/tutorial/bff_wireframe.jpg" width="376" height="219" align="center" />

            <h3 id="tutorial_gui">Target Boundary</h3>
            <p>A key functionality provided by BFF is the ability to change the target shape of the flattening, by manipulating its boundary curve. No matter what target shape is used, BFF will tend to reduce a map with very low distortion, so that textures
                and other data can still be nicely mapped back onto the original surface. Several possibilities are accessible through the graphical interface (and additional possibilities are available through source code-level access):</p>

            <ul>
                <li><em>Automatic</em> &mdash; if no special control over the boundary is required, BFF automatically produces the flattening with minimal area distortion. (Note that since we mathematically guarantee that this is the lowest area distortion,
                    it is not possible to reduce area distortion by using different flattening software. However, area distortion <em>can</em> be reduced by adding cuts and cone singularities; see below.)</li>
                <li><em>Disk</em> &mdash; maps the surface to a circular disk. This map provides an easy way to get a map between two different surfaces (<em>e.g.,</em> two different faces): just map each surface to the disk independently, then to locate
                    a point in the 2nd mesh corresponding to a given point on the 1st mesh, follow the maps from the 1st surface, to the disk, and then back to the 2nd surface. (Expert comment: there are <em>M&ouml;bius</em> degrees of freedom that are
                    not exposed by the GUI; direct control over these degrees of freedom may be supported in a future release.)</li>
                <li><em>Edit Boundary</em> &mdash; provides direct manipulation of the boundary curve using a user-specified spline. Control points can be added (or removed) by clicking (or ctrl-clicking) points on the boundary. Clicking and dragging on a
                    handle will change the scale; holding shift will control the angle instead of the scale.</li>
                <li><em>Set Boundary Angles</em> &mdash; allows the corner angles of a polygon to be specified. Angles can be specified using the <b>Angle Control</b> slider, or by typing in the angle box (where the value is interpreted as a multiple of &pi;).
                    As with any polygon, these angles must of course sum to 2&pi;&mdash; the GUI will automatically adjust the angles to preserve this sum at all times, by adjusting the angle at the corner that was least-recently updated.</li>
            </ul>

            <img src="imgs/tutorial/bff_targetboundary.jpg" width="743" height="225" align="center" />

            <h3 id="tutorial_cones">Cone Singularities</h3>

            <p>In general, it is impossible to flatten a surface perfectly. Somewhere, there <em>must</em> be distortion of either angles or areas. BFF can produce flattenings with minimal area distortion and virtually zero angle distortion, but in some
                situations area distortion is still too high for practical use. One solution is to cut the mesh into smaller pieces, each of which is easier to flatten, but typically this is unnecessarily aggressive. One can instead reduce distortion
                to more reasonable levels by inserting <em>cone singularities</em>, which play much the same role as &ldquo;darts&rdquo; in garment design. The BFF GUI makes it easy to explore the effect of placing cones, and also provides the ability
                to place cones automatically in order to reduce area distortion.</p>

            <h4 id="tutorial_manualcones">Manual Cone Placement</h4>

            <p>The easiest way to add cones is simply to click on any point of the surface in either the <b>3D View</b> or <b>UV View</b> while the target boundary is set to <b>Automatic</b> or <b>Disk</b>. Doing so will insert a cone at the click location,
                find a cut from this cone to the boundary, and update the flattening. Additional clicks will add additional cones. To see the effect on area distortion, set the plot mode to <b>Area Distortion</b>, which will show the distribution of area
                distortion over the suface (as described above). Clicking on regions of high area distortion will tend to reduce it. Drawing a pattern (such as grid or checkerboard) will also provide some sense of how much scale distortion remains. Note
                that a <em>poor</em> choice of cones can actually <em>increase</em> area distortion&mdash; some experimentation may be required here. Alternatively, one can try the automatic placement button, as described below. (Cuts are picked automatically
                in the GUI; the cutting strategy can currently only be changed via source-level modifications to BFF.)</p>

            <img src="imgs/tutorial/bff_cones.jpg" width="457" height="205" align="center" />

            <p>The <b>Angle Control</b> slider allows the cone angle to be adjusted; alternatively, one may type in a specific cone angle (as a multiple of &pi;). The cone angle can be understood in analogy with &ldquo;darts&rdquo; in dressmaking: smaller
                angles will typically accommodate less curvature; large angles are helpful for highly curved regions. For spherical surfaces (with no boundary) the total angle sum must be 4&pi; at all times; the GUI will automatically adjust the least-recently
                updated cone to make sure this sum holds.</p>

            <img src="imgs/tutorial/bff_coneangle.jpg" width="490" height="210" align="center" />

            <h4 id="tutorial_autocones">Automatic Cone Placement</h4>
            <p>A target number of cones can also be placed by simply pressing the <b>Place Cones</b> button. The number of cones can be specified in the <b># Cones</b> field. Note that computing these cones may take some time, especially for meshes with
                many boundary vertices. (This feature will be improved in future versions; stay tuned!)</p>

            <img src="imgs/tutorial/bff_autocones.jpg" width="299" height="206" align="center" />

            <h3 id="tutorial_sphere">Spherical Parameterization</h3>
            <p>For sphere-like surfaces, BFF will also automatically produce a map to the sphere; simply press the <b>Map to Sphere</b> button. For maps to the sphere, there is less control that can be provided to the user since there is no boundary to edit!
                (Future versions may expose M&ouml;bius degrees of freedom, as with the disk.)</p>

            <img src="imgs/tutorial/bff_sphere.jpg" width="516" height="280" align="center" />

            <p>To get a map with lower area distortion, once can again add cone singularities (either automatically or manually) as described above. The surface will automatically be cut into a disk and flattened.</p>

            <img src="imgs/tutorial/bff_spherecones.jpg" width="472" height="224" align="center" />

            <h1 id="compiling">Compiling from source</h1>

            <p>On Mac OSX and Linux, compiling should be as simple as</p>

            <div class="highlighter-rouge">
                <div class="highlight"><pre class="highlight"><code>git clone https://github.com/rohan-sawhney/boundary-first-flattening.git
cd boundary-first-flattening &amp;&amp; git submodule update --init --recursive
mkdir build &amp;&amp; cd build &amp;&amp; cmake ..
make -j 4
./bff
</code></pre></div>
            </div>

            <p>On Windows, create a Visual Studio project with Cmake after running the first three instructions above.</p>

            <h3 id="dependencies">Dependencies</h3>

            <ol>
                <li><a href="http://faculty.cse.tamu.edu/davis/suitesparse.html">SuiteSparse</a> (instructions to build SuiteSparse on Windows can be found <a href="https://github.com/jlblancoc/suitesparse-metis-for-windows">here</a>)</li>
                <li>OpenGL (version 4.1 or higher)</li>
                <li><a href="http://glm.g-truc.net/0.9.8/index.html">OpenGL Mathematics (GLM)</a> (included)</li>
                <li><a href="https://github.com/wjakob/nanogui">Nanogui</a> (included)</li>
            </ol>

            <h1 id="authors">Authors</h1>
            <p><a href="http://www.rohansawhney.io">Rohan Sawhney</a><br />
                <a href="http://www.cs.cmu.edu/~kmcrane/">Keenan Crane</a></p>

            <h1 id="publication">Publication</h1>

            <blockquote>
                <p><strong><a href="https://arxiv.org/abs/1704.06873">Boundary First Flattening</a></strong><br /> Sawhney, Crane<br /> ACM Transactions on Graphics</p>
            </blockquote>

            <h1 id="license">License</h1>

            <p>Released under the <a href="https://opensource.org/licenses/MIT">MIT License</a></p>

        </section>
    </div>
    <script src="/boundary-first-flattening/assets/js/scale.fix.js"></script>



</body>

</html>